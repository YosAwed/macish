　このISHは、毎黒仮節渡万がISH UNIX Ver.2.01a4に若干の修正を加えてMS-DOS
に逆移植し、さらにComWinに対応させたものです。同梱のバイナリはComWinの
16ビット版・32ビット版です。

※ComWinは前寺正彦氏のMS-Windows用CUIシェルです。

【変更点】

	・メッセージで2.01a3のままだった部分を2.01a4に書き換えました。
	・タイトル行を短くして、多くのパソコン通信ホストの「一行79文字
	　制限」をできるだけ超えないようにしました。
	・16ビットOSでもコンパイルできるよう、long型関数と、long型引数
	　を持つ関数のプロトタイプ宣言を明確にしました。
	・MS-DOSでディレクトリ記号を"\"にしました。
	・MS-DOSでish.comと同様に使えるよう、オプション記号"/"にしました。
	・MS-DOSで一時ファイル検索に失敗することがあるので、strncmpから
	　strnicmpに変えました。
	・MS-DOSでテキストファイルの特殊性(EOF=1Ah、改行=CR+LF)からくる
	　不具合の解消をしました。ターゲットファイルをバイナリファイル
	　として扱います。
	・MS-Windowsの32ビット環境で、長いファイル名に対応させました。
	　本ish及び小笠原博之氏のaishによるファイルであれば、タイトル行
	　からファイル名を取得し、復元することができます。ヘッダーには
	　MS-DOSファイル名が格納されます。
	・ファイル名にマルチバイト文字が含まれていても、文字列操作を正
	　しく行なえるようにしました(マクロMBFNAME)。

　「MS-DOSで」は条件コンパイルで分けていますので、ソースの扱いはUNIXで
は2.01a4と変わりません。最後の「バイナリファイル扱い」は、オリジナルの
Ver.2.01がTurboCを想定しているものでしたので、これを踏襲しました。特化
したことはしていないはずなので、他のコンパイラでもマクロ"__TURBOC__"を
定義すれば通ると思います。
　「MS-DOSで」はマクロ"__MSDOS__"、「MS-Windowsの32ビット環境で」はマ
クロ"__WIN32__"です。ComWin対応は"__COMWIN__"で行なっています。


【長いファイル名】

　手近にUNIX環境がないので、WindowsNT/95のみとしています。aishの場合は
その最大字数まで、本ish(本家ish.comやUNIX ish、CP/M ishなどとの区別は
つかないが)の場合は、スペースを含むファイル名であっても復元できます。
このタイトル行からのファイル名取得は、まさしくaishが行なっていることで
あり、参考にさせていただいています。
　いずれもタイトル行の直後に変換されたファイル本体が来ている場合のみで、
さもなくば従来通りヘッダーからファイル名を取得します。
　エンコードの際ヘッダーに格納するファイル名は、MS-DOSファイル名の取得
に失敗した場合は先頭11文字(拡張子ピリオド除く)を使います。このとき、
拡張子ピリオドをまたぐように漢字があったり、あるいは最後11字目に漢字の
1バイト目が来る場合、これを"_"に変換しています。また、スペースが含まれ
るファイル名は、スペースを無視して詰めています。
　言うまでもないことですが、通信手段によっては1行79バイトを越えること
ができません。タイトルが長すぎて途中に改行が入れられた場合、タイトル行
からのファイル名取得は働かないことになります。


【コンパイル】

　開発環境はBorlandC++4.02Jです。ただし、新規API使用のため、一部のWindows
ヘッダーとインポートライブラリを拡張しています(GetShortPathName)。
　make制御ファイルは、makefile.cwでComWin版が、makefile.dosでDOS版が生
成できます。このmakefile.cwは、32ビット版では動くかどうか未確認です。
BC++4.0ではコマンドライン版コンパイラで一部のソースが通らず、統合環境で
開発したため、確認できなかったからです。オプションに関しては全く同一で
すので、参考にしてください。
　makefile.dosは、移植途中の名残です。現在は使っていませんが、デバッグ
の足しになればと思います。
　なお、統合環境でコンパイルするに当たり、マクロ"__MSDOS__"を定義しな
ければならないことをつけ加えておきます。これはWindows3.1においても例外
ではありません。


【改造・改良をされる方へ】

　BC++4.0ではモジュール名に拡張子が含まれてしまうようです。このため、他
のコンパイラではソースの一部書き替えが必要になる可能性があります。
winmain.cのMakeArgument関数呼び出しがそれに当たります。
　obsolete警告が出ている関数がいくつかあります。古い関数ということで、
新しいコンパイラでは通らない可能性があります。


【謝辞】

　オリジナルを製作された石塚匡哉氏、そしてKen氏、Gigo氏をはじめC言語版
ISHに携われた全ての方、aishの小笠原博之氏に感謝いたします。
　winmain.cは基本的に、IRUKA氏による同名のPDS扱いのソースと、前寺正彦氏
御自身によるComWinアプリケーションのサンプルソースを参考にしています。
積極的にソースの公開をなさった両氏に感謝いたします。
　最後に、ComWinを作られた前寺正彦氏に改めて感謝いたします。


【取扱い】

　毎黒仮節渡万が製作したアイコンを含めUNIX版に準じます。従ってPDSです。


                                                                毎黒仮節渡万
                                                            MicroCassetteMan
                                                        HXD08184@pcvan.or.jp
